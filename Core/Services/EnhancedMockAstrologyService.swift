//
//  EnhancedMockAstrologyService.swift
//  Astrolog
//
//  Created by Sergey on 19.09.2025.
//
// Core/Services/EnhancedMockAstrologyService.swift
import Foundation
import Combine

class EnhancedMockAstrologyService: AstrologyServiceProtocol {
    
    func calculateBirthChart(from birthData: BirthData) async throws -> BirthChart {
        try await Task.sleep(nanoseconds: 2_000_000_000)
        
        let planets = generatePlanets(for: birthData)
        let houses = generateHouses()
        let aspects = generateAspects()
        
        return BirthChart(
            id: UUID().uuidString,
            userId: "user_123",
            name: "Birth Chart",
            birthDate: birthData.date,
            birthTime: DateFormatter.localizedString(from: birthData.date, dateStyle: .none, timeStyle: .short),
            location: "\(birthData.cityName), \(birthData.countryName)",
            latitude: birthData.latitude,
            longitude: birthData.longitude,
            planets: planets,
            houses: houses,
            aspects: aspects,
            calculatedAt: Date()
        )
    }
    
    func generateDailyHoroscope(for sunSign: ZodiacSign, date: Date = Date()) async throws -> DailyHoroscope {
        try await Task.sleep(nanoseconds: 1_500_000_000)

        let template = generateDynamicHoroscope(for: sunSign, date: date)

        return DailyHoroscope(
            date: date,
            sunSign: sunSign,
            summary: template.general.components(separatedBy: ". ").first ?? template.general,
            detailedForecast: "\(template.general) \(template.advice)",
            generalForecast: template.general,
            loveAndRelationships: template.love,
            careerAndFinances: template.career,
            healthAndEnergy: template.health,
            energyLevel: calculateEnergyLevel(for: sunSign, date: date),
            keyThemes: generateDynamicKeyThemes(for: sunSign, date: date),
            luckyNumbers: generateLuckyNumbers(),
            luckyColors: generateLuckyColors(for: sunSign),
            advice: template.advice
        )
    }

    private func generateDynamicHoroscope(for sign: ZodiacSign, date: Date) -> (general: String, love: String, career: String, health: String, advice: String) {
        let calendar = Calendar.current
        let dayOfWeek = calendar.component(.weekday, from: date)
        let weekOfYear = calendar.component(.weekOfYear, from: date)

        // Добавляем вариативность на основе даты
        let seedValue = dayOfWeek + weekOfYear + sign.rawValue

        let generalTexts = getGeneralTexts(for: sign)
        let loveTexts = getLoveTexts(for: sign)
        let careerTexts = getCareerTexts(for: sign)
        let healthTexts = getHealthTexts(for: sign)
        let adviceTexts = getAdviceTexts(for: sign)

        // Выбираем тексты на основе seedValue для псевдослучайности, но стабильности в течение дня
        return (
            general: addDateContext(generalTexts[seedValue % generalTexts.count], date: date, dayOfWeek: dayOfWeek),
            love: loveTexts[seedValue % loveTexts.count],
            career: careerTexts[seedValue % careerTexts.count],
            health: healthTexts[seedValue % healthTexts.count],
            advice: adviceTexts[seedValue % adviceTexts.count]
        )
    }

    private func addDateContext(_ baseText: String, date: Date, dayOfWeek: Int) -> String {
        let timeContexts = [
            "Сегодня особенно важно", "В этот день стоит обратить внимание на то, что",
            "Текущие планетарные влияния говорят о том, что", "День располагает к тому, чтобы"
        ]

        let weekdayModifiers = [
            1: "В начале новой недели", // Воскресенье
            2: "В этот понедельник",
            3: "Во вторник энергии способствуют тому, что",
            4: "Середина недели подходит для того, чтобы",
            5: "В четверг особенно заметно, что",
            6: "Пятничные энергии показывают, что",
            7: "В субботу важно помнить, что"
        ]

        let contextIndex = abs(dayOfWeek + date.hashValue) % timeContexts.count
        let context = timeContexts[contextIndex]
        let safeWeekday = ((dayOfWeek - 1) % 7) + 1 // Приводим к диапазону 1-7
        let modifier = weekdayModifiers[safeWeekday] ?? ""

        return "\(modifier) \(context.lowercased()) \(baseText.lowercased())"
    }

    private func calculateEnergyLevel(for sign: ZodiacSign, date: Date) -> Int {
        let calendar = Calendar.current
        let dayOfYear = calendar.ordinality(of: .day, in: .year, for: date) ?? 1

        // Базовая энергия знака
        let baseEnergy = switch sign {
        case .aries, .leo, .sagittarius: 8 // Огненные знаки
        case .taurus, .virgo, .capricorn: 6 // Земные знаки
        case .gemini, .libra, .aquarius: 7 // Воздушные знаки
        case .cancer, .scorpio, .pisces: 5 // Водные знаки
        }

        // Добавляем вариативность на основе дня
        let dayVariation = (dayOfYear + sign.rawValue) % 5 - 2 // от -2 до +2

        return max(1, min(10, baseEnergy + dayVariation))
    }

    private func generateDynamicKeyThemes(for sign: ZodiacSign, date: Date) -> [String] {
        let calendar = Calendar.current
        let month = calendar.component(.month, from: date)

        let seasonalThemes = getSeasonalThemes(month: month)
        let signThemes = getSignSpecificThemes(for: sign)

        let themes = seasonalThemes + signThemes
        let seedValue = calendar.component(.day, from: date) + sign.rawValue

        var generator = SeededRandomNumberGenerator(seed: seedValue)
        return Array(themes.shuffled(using: &generator).prefix(Int.random(in: 2...4)))
    }

    private func getSeasonalThemes(month: Int) -> [String] {
        switch month {
        case 12, 1, 2: return ["Рефлексия", "Планирование", "Внутренняя работа", "Семейные связи"]
        case 3, 4, 5: return ["Обновление", "Рост", "Новые начинания", "Творчество"]
        case 6, 7, 8: return ["Активность", "Путешествия", "Общение", "Отдых"]
        case 9, 10, 11: return ["Достижения", "Стабильность", "Подготовка", "Мудрость"]
        default: return ["Гармония", "Баланс"]
        }
    }

    private func getSignSpecificThemes(for sign: ZodiacSign) -> [String] {
        switch sign {
        case .aries: return ["Лидерство", "Инициатива", "Энергия", "Новые проекты"]
        case .taurus: return ["Стабильность", "Материальное благополучие", "Комфорт", "Настойчивость"]
        case .gemini: return ["Общение", "Обучение", "Гибкость", "Информация"]
        case .cancer: return ["Семья", "Эмоции", "Забота", "Дом"]
        case .leo: return ["Творчество", "Самовыражение", "Щедрость", "Признание"]
        case .virgo: return ["Организация", "Здоровье", "Детали", "Служение"]
        case .libra: return ["Гармония", "Отношения", "Красота", "Справедливость"]
        case .scorpio: return ["Трансформация", "Глубина", "Страсть", "Тайны"]
        case .sagittarius: return ["Философия", "Путешествия", "Мудрость", "Свобода"]
        case .capricorn: return ["Карьера", "Ответственность", "Достижения", "Структура"]
        case .aquarius: return ["Инновации", "Дружба", "Независимость", "Гуманизм"]
        case .pisces: return ["Интуиция", "Сострадание", "Искусство", "Духовность"]
        }
    }
    
    func calculateCompatibility(chart1: BirthChart, chart2: BirthChart) async throws -> CompatibilityResult {
        try await Task.sleep(nanoseconds: 2_000_000_000)
        
        let baseScore = Double.random(in: 55...95)
        
        return CompatibilityResult(
            id: UUID().uuidString,
            chart1UserId: chart1.userId,
            chart2UserId: chart2.userId,
            overallScore: baseScore,
            categories: CompatibilityCategories(
                communication: max(0, min(100, baseScore + Double.random(in: -15...15))),
                emotional: max(0, min(100, baseScore + Double.random(in: -10...10))),
                intellectual: max(0, min(100, baseScore + Double.random(in: -12...12))),
                physical: max(0, min(100, baseScore + Double.random(in: -8...8))),
                spiritual: max(0, min(100, baseScore + Double.random(in: -5...5)))
            ),
            strengths: [
                "Отличное взаимопонимание в общении",
                "Похожие жизненные ценности",
                "Дополняете друг друга эмоционально"
            ],
            challenges: [
                "Различия в подходе к финансам",
                "Иногда конкуренция в творчестве"
            ],
            advice: "Цените различия друг друга и находите компромиссы в спорных вопросах."
        )
    }
    
    func getCurrentTransits() async throws -> [Transit] {
        try await Task.sleep(nanoseconds: 1_000_000_000)
        
        return [
            Transit(
                planet: .venus,
                sign: .taurus,
                aspectType: .trine,
                natalPlanet: .sun,
                startDate: Date(),
                endDate: Calendar.current.date(byAdding: .day, value: 15, to: Date()) ?? Date(),
                description: "Венера образует тригон к вашему натальному Солнцу",
                influence: "Период гармонии в отношениях и творческого вдохновения",
                influenceLevel: 4
            ),
            Transit(
                planet: .mars,
                sign: .aries,
                aspectType: .square,
                natalPlanet: .mercury,
                startDate: Date(),
                endDate: Calendar.current.date(byAdding: .day, value: 7, to: Date()) ?? Date(),
                description: "Марс образует квадрат к вашему Меркурию",
                influence: "Возможны конфликты в общении, будьте осторожны с словами",
                influenceLevel: 3
            )
        ]
    }
    
    // MARK: - Private Methods
    
    private func generatePlanets(for birthData: BirthData) -> [Planet] {
        var planets: [Planet] = []
        
        for planetType in PlanetType.allCases {
            let sign = getRandomSign()
            let house = Int.random(in: 1...12)
            let longitude = Double(sign.rawValue * 30) + Double.random(in: 0...30)
            
            let planet = Planet(
                id: UUID().uuidString,
                type: planetType,
                longitude: longitude,
                zodiacSign: sign,
                house: house,
                isRetrograde: Bool.random()
            )
            planets.append(planet)
        }
        
        return planets
    }
    
    private func generateHouses() -> [House] {
        var houses: [House] = []
        
        for number in 1...12 {
            let house = House(
                id: UUID().uuidString,
                number: number,
                cuspLongitude: Double((number - 1) * 30),
                zodiacSign: getRandomSign(),
                planetsInHouse: []
            )
            houses.append(house)
        }
        
        return houses
    }
    
    private func generateAspects() -> [Aspect] {
        let aspects: [Aspect] = [
            Aspect(
                id: UUID().uuidString,
                planet1: .sun,
                planet2: .moon,
                type: .trine,
                orb: 3.2,
                isApplying: true
            ),
            Aspect(
                id: UUID().uuidString,
                planet1: .venus,
                planet2: .mars,
                type: .conjunction,
                orb: 1.8,
                isApplying: false
            )
        ]
        
        return aspects
    }
    
    private func getRandomSign() -> ZodiacSign {
        return ZodiacSign.allCases.randomElement() ?? .aries
    }
    
    private func getHoroscope(for sign: ZodiacSign) -> (general: String, love: String, career: String, health: String, advice: String) {
        switch sign {
        case .aries:
            return (
                general: "Сегодня ваша энергия на пике. Отличный день для начала новых проектов.",
                love: "Страсть и инициатива в отношениях принесут результат.",
                career: "Время решительных действий и смелых решений.",
                health: "Высокий уровень энергии, но не забывайте о безопасности.",
                advice: "Действуйте, но не забывайте думать о последствиях."
            )
        case .taurus:
            return (
                general: "День стабильности и практичности. Сосредоточьтесь на материальных вопросах.",
                love: "В отношениях ценится надежность и постоянство.",
                career: "Хорошее время для финансового планирования.",
                health: "Обратите внимание на питание и физическую активность.",
                advice: "Терпение и упорство приведут к успеху."
            )
        case .gemini:
            return (
                general: "День общения и новой информации. Ваше любопытство будет вознаграждено.",
                love: "Интеллектуальная близость важнее физической.",
                career: "Отличное время для переговоров и презентаций.",
                health: "Следите за нервной системой, избегайте перенапряжения.",
                advice: "Будьте открыты к новым знакомствам и идеям."
            )
        case .cancer:
            return (
                general: "Интуиция подскажет правильный путь. Доверьтесь своим чувствам.",
                love: "Семья и близкие отношения в приоритете.",
                career: "Хороший день для работы в команде и заботы о коллегах.",
                health: "Обратите внимание на пищеварение и эмоциональное состояние.",
                advice: "Создайте уютную атмосферу вокруг себя."
            )
        case .leo:
            return (
                general: "Сегодня ваша харизма особенно сильна. Звезды благоволят творческим начинаниям.",
                love: "В отношениях период страсти и романтики. Не бойтесь проявлять чувства.",
                career: "Отличное время для презентаций и публичных выступлений.",
                health: "Энергия на высоком уровне, но не забывайте об отдыхе.",
                advice: "Доверьтесь своему сердцу и не бойтесь быть в центре внимания."
            )
        case .virgo:
            return (
                general: "День для детального анализа и планирования. Внимание к мелочам принесет успех.",
                love: "Практическая забота лучше громких слов.",
                career: "Идеальное время для организации и систематизации работы.",
                health: "Следите за режимом дня и правильным питанием.",
                advice: "Совершенство достигается в деталях."
            )
        case .libra:
            return (
                general: "День гармонии и справедливости. Стремитесь к балансу во всем.",
                love: "Романтика и красота украсят ваши отношения.",
                career: "Хорошее время для партнерства и сотрудничества.",
                health: "Займитесь эстетическими процедурами и релаксацией.",
                advice: "Ищите компромиссы и избегайте конфликтов."
            )
        case .scorpio:
            return (
                general: "Интенсивный день трансформаций. Глубокие изменения к лучшему.",
                love: "Страстность и глубина чувств определяют отношения.",
                career: "Время для важных решений и кардинальных перемен.",
                health: "Обратите внимание на восстановление и регенерацию.",
                advice: "Не бойтесь отпустить старое, чтобы принять новое."
            )
        case .sagittarius:
            return (
                general: "День приключений и новых горизонтов. Расширяйте свои границы.",
                love: "Свобода и искренность укрепляют отношения.",
                career: "Отличное время для обучения и развития навыков.",
                health: "Активный отдых на природе пойдет на пользу.",
                advice: "Следуйте за своими мечтами и не ограничивайте себя."
            )
        case .capricorn:
            return (
                general: "День амбиций и достижений. Упорный труд приносит результаты.",
                love: "Серьезные намерения и долгосрочные планы в отношениях.",
                career: "Время для карьерного роста и профессиональных достижений.",
                health: "Укрепляйте костную систему и суставы.",
                advice: "Терпение и дисциплина - ваши главные помощники."
            )
        case .aquarius:
            return (
                general: "День инноваций и оригинальности. Ваши необычные идеи найдут понимание.",
                love: "Дружба - основа крепких отношений.",
                career: "Хорошее время для работы с технологиями и в команде.",
                health: "Следите за кровообращением и нервной системой.",
                advice: "Будьте верны себе и не бойтесь выделяться."
            )
        case .pisces:
            return (
                general: "Интуитивный день, полный творчества и вдохновения.",
                love: "Эмпатия и понимание углубляют связь с партнером.",
                career: "Творческие проекты и работа с людьми принесут удовлетворение.",
                health: "Обратите внимание на ноги и лимфатическую систему.",
                advice: "Доверяйтесь интуиции и не забывайте о реальности."
            )
        }
    }
    
    private func generateLuckyNumbers() -> [Int] {
        return Array(1...49).shuffled().prefix(6).sorted()
    }
    
    private func generateLuckyColors(for sign: ZodiacSign) -> [String] {
        let colors = ["Красный", "Синий", "Зеленый", "Золотой", "Серебряный", "Фиолетовый"]
        return Array(colors.shuffled().prefix(3))
    }

    private func generateKeyThemes(for sign: ZodiacSign) -> [String] {
        let allThemes = [
            "Творчество", "Любовь", "Карьера", "Здоровье", "Финансы",
            "Семья", "Дружба", "Путешествия", "Обучение", "Медитация",
            "Интуиция", "Общение", "Спорт", "Искусство", "Природа"
        ]
        return Array(allThemes.shuffled().prefix(Int.random(in: 2...4)))
    }

    // MARK: - Dynamic Text Generation

    private func getGeneralTexts(for sign: ZodiacSign) -> [String] {
        switch sign {
        case .aries:
            return [
                "ваша энергия и инициатива откроют новые возможности.",
                "импульсивные решения могут привести к неожиданным результатам.",
                "лидерские качества помогут вам вдохновить окружающих.",
                "активные действия принесут больше пользы, чем размышления."
            ]
        case .taurus:
            return [
                "стабильность и настойчивость станут вашими главными союзниками.",
                "материальные вопросы требуют особого внимания.",
                "чувственные удовольствия подарят умиротворение.",
                "терпение поможет достичь долгосрочных целей."
            ]
        case .gemini:
            return [
                "общение и новые знакомства откроют интересные перспективы.",
                "информация, полученная сегодня, может быть особенно ценной.",
                "гибкость мышления поможет найти нестандартные решения.",
                "разнообразие деятельности принесет радость и энергию."
            ]
        case .cancer:
            return [
                "интуиция подскажет правильный путь в важных решениях.",
                "семейные и домашние дела требуют вашего внимания.",
                "эмоциональная чувствительность поможет понять других.",
                "забота о близких принесет глубокое удовлетворение."
            ]
        case .leo:
            return [
                "творческое самовыражение откроет новые таланты.",
                "щедрость и великодушие привлекут к вам людей.",
                "яркая личность поможет добиться признания.",
                "уверенность в себе станет ключом к успеху."
            ]
        case .virgo:
            return [
                "внимание к деталям поможет избежать ошибок.",
                "организованность и планирование принесут результаты.",
                "забота о здоровье должна быть приоритетом.",
                "практический подход решит многие проблемы."
            ]
        case .libra:
            return [
                "гармония в отношениях станет источником силы.",
                "чувство справедливости поможет разрешить конфликты.",
                "красота и эстетика вдохновят на новые идеи.",
                "дипломатические способности откроют новые возможности."
            ]
        case .scorpio:
            return [
                "глубокие трансформации принесут обновление жизни.",
                "интенсивные эмоции требуют мудрого управления.",
                "тайны и скрытые мотивы могут раскрыться.",
                "сила воли поможет преодолеть любые препятствия."
            ]
        case .sagittarius:
            return [
                "философские размышления расширят понимание мира.",
                "путешествия или новый опыт обогатят ваше мировоззрение.",
                "оптимизм и вера в лучшее привлекут удачу.",
                "стремление к свободе откроет новые горизонты."
            ]
        case .capricorn:
            return [
                "целеустремленность и дисциплина приведут к достижениям.",
                "профессиональные амбиции получат поддержку звезд.",
                "ответственность за других принесет уважение.",
                "структурный подход поможет организовать хаос."
            ]
        case .aquarius:
            return [
                "инновационные идеи найдут понимание и поддержку.",
                "дружеские связи станут источником вдохновения.",
                "независимость мышления поможет найти уникальные решения.",
                "гуманитарные идеи получат развитие."
            ]
        case .pisces:
            return [
                "интуитивные озарения откроют скрытые истины.",
                "творческое вдохновение достигнет новых высот.",
                "сострадание к другим принесет духовное удовлетворение.",
                "мистические практики усилят внутреннюю связь."
            ]
        }
    }

    private func getLoveTexts(for sign: ZodiacSign) -> [String] {
        switch sign {
        case .aries:
            return [
                "В отношениях проявите больше терпения и понимания.",
                "Страстные чувства могут вспыхнуть с новой силой.",
                "Инициатива в любви принесет неожиданные плоды.",
                "Прямота в выражении чувств будет оценена."
            ]
        case .taurus:
            return [
                "Стабильность в отношениях принесет глубокое удовлетворение.",
                "Чувственность и нежность укрепят близость.",
                "Материальные подарки станут выражением любви.",
                "Верность и преданность получат признание."
            ]
        case .gemini:
            return [
                "Интеллектуальное общение сблизит вас с партнером.",
                "Разнообразие в отношениях добавит новых красок.",
                "Легкость и юмор помогут преодолеть трудности.",
                "Новые знакомства могут перерасти в нечто большее."
            ]
        case .cancer:
            return [
                "Эмоциональная близость станет основой крепких отношений.",
                "Семейные ценности получат особое значение.",
                "Интуиция поможет понять потребности любимого человека.",
                "Забота и опека будут особенно важны."
            ]
        case .leo:
            return [
                "Щедрость в проявлении чувств привлечет взаимность.",
                "Творческие совместные проекты укрепят союз.",
                "Яркость и театральность в отношениях добавят страсти.",
                "Гордость за партнера станет источником радости."
            ]
        case .virgo:
            return [
                "Практическая помощь станет лучшим выражением любви.",
                "Внимание к мелочам покажет глубину чувств.",
                "Здоровые отношения требуют заботы о себе.",
                "Совершенство в мелочах принесет гармонию."
            ]
        case .libra:
            return [
                "Гармония и баланс в отношениях станут приоритетом.",
                "Красота и романтика окрасят ваши встречи.",
                "Справедливость в отношениях укрепит доверие.",
                "Компромиссы помогут сохранить мир."
            ]
        case .scorpio:
            return [
                "Глубина чувств может достичь новых высот.",
                "Страсть и интенсивность добавят остроты отношениям.",
                "Скрытые эмоции требуют честного выражения.",
                "Трансформация в отношениях принесет обновление."
            ]
        case .sagittarius:
            return [
                "Свобода в отношениях станет залогом их крепости.",
                "Совместные путешествия укрепят связь.",
                "Оптимизм поможет преодолеть любые кризисы.",
                "Философские беседы сблизят души."
            ]
        case .capricorn:
            return [
                "Серьезные намерения в любви получат поддержку.",
                "Стабильность отношений станет фундаментом счастья.",
                "Ответственность друг за друга укрепит союз.",
                "Долгосрочные планы вместе обретут реальность."
            ]
        case .aquarius:
            return [
                "Дружба станет основой романтических отношений.",
                "Независимость в отношениях сохранит их свежесть.",
                "Необычные формы выражения любви найдут отклик.",
                "Общие идеалы сплотят ваши сердца."
            ]
        case .pisces:
            return [
                "Интуитивное понимание партнера достигнет совершенства.",
                "Романтические мечты могут воплотиться в реальность.",
                "Сострадание и жертвенность углубят чувства.",
                "Духовная связь превзойдет физическое влечение."
            ]
        }
    }

    private func getCareerTexts(for sign: ZodiacSign) -> [String] {
        switch sign {
        case .aries:
            return [
                "Лидерские качества помогут вам возглавить важный проект.",
                "Инициатива в работе будет замечена руководством.",
                "Конкуренция может стимулировать к новым достижениям.",
                "Быстрые решения принесут преимущество в бизнесе."
            ]
        case .taurus:
            return [
                "Стабильный доход и финансовая безопасность в фокусе.",
                "Настойчивость в работе приведет к долгосрочному успеху.",
                "Практические навыки будут особенно востребованы.",
                "Материальные инвестиции могут принести прибыль."
            ]
        case .gemini:
            return [
                "Коммуникативные навыки откроют новые возможности.",
                "Разнообразные проекты принесут интеллектуальное удовлетворение.",
                "Обучение новым навыкам ускорит карьерный рост.",
                "Гибкость в работе станет вашим преимуществом."
            ]
        case .cancer:
            return [
                "Работа в команде принесет наилучшие результаты.",
                "Интуиция поможет принять правильные бизнес-решения.",
                "Забота о клиентах укрепит профессиональную репутацию.",
                "Домашний офис может стать более продуктивным."
            ]
        case .leo:
            return [
                "Творческие проекты получат признание и поддержку.",
                "Ваши таланты будут замечены влиятельными людьми.",
                "Публичные выступления принесут профессиональный успех.",
                "Щедрость к коллегам вернется сторицей."
            ]
        case .virgo:
            return [
                "Внимание к деталям поможет избежать дорогих ошибок.",
                "Организационные способности будут особенно ценны.",
                "Здоровье на рабочем месте требует внимания.",
                "Совершенствование навыков откроет новые перспективы."
            ]
        case .libra:
            return [
                "Дипломатические навыки помогут разрешить рабочие конфликты.",
                "Партнерства в бизнесе принесут взаимную выгоду.",
                "Эстетический подход к работе найдет понимание.",
                "Справедливость в отношениях с коллегами укрепит позиции."
            ]
        case .scorpio:
            return [
                "Исследовательская работа принесет важные открытия.",
                "Способность видеть скрытое поможет в анализе.",
                "Трансформация рабочих процессов улучшит результаты.",
                "Интенсивная работа принесет значительные достижения."
            ]
        case .sagittarius:
            return [
                "Международные проекты откроют новые горизонты.",
                "Обучающая деятельность принесет удовлетворение.",
                "Философский подход к работе найдет применение.",
                "Свобода в выборе методов работы повысит эффективность."
            ]
        case .capricorn:
            return [
                "Карьерные амбиции получат мощную поддержку звезд.",
                "Дисциплинированный подход приведет к руководящим позициям.",
                "Ответственность за результаты команды принесет признание.",
                "Долгосрочные профессиональные цели станут достижимыми."
            ]
        case .aquarius:
            return [
                "Инновационные идеи найдут практическое применение.",
                "Работа в IT или с новыми технологиями будет особенно успешной.",
                "Независимый подход к работе принесет лучшие результаты.",
                "Гуманитарные проекты получат неожиданную поддержку."
            ]
        case .pisces:
            return [
                "Творческие профессии принесут наибольшее удовлетворение.",
                "Интуиция поможет понять потребности клиентов.",
                "Работа в сфере заботы о людях будет особенно благоприятна.",
                "Мистические или духовные практики могут стать источником дохода."
            ]
        }
    }

    private func getHealthTexts(for sign: ZodiacSign) -> [String] {
        switch sign {
        case .aries:
            return [
                "Энергичные тренировки помогут поддержать жизненный тонус.",
                "Берегите голову от травм и переохлаждения.",
                "Активный образ жизни станет лучшей профилактикой.",
                "Импульсивность может привести к мелким травмам."
            ]
        case .taurus:
            return [
                "Обратите внимание на питание и пищеварение.",
                "Массаж и СПА-процедуры принесут расслабление.",
                "Горло и шея требуют особой заботы.",
                "Стабильный режим дня улучшит самочувствие."
            ]
        case .gemini:
            return [
                "Дыхательные практики помогут снять стресс.",
                "Берегите руки и плечи от перенапряжения.",
                "Ментальная активность требует физической разрядки.",
                "Разнообразие в питании обеспечит необходимые витамины."
            ]
        case .cancer:
            return [
                "Пищеварительная система требует особого внимания.",
                "Эмоциональное состояние напрямую влияет на здоровье.",
                "Забота о груди и желудке должна быть приоритетом.",
                "Водные процедуры принесут оздоровление."
            ]
        case .leo:
            return [
                "Сердечно-сосудистая система нуждается в поддержке.",
                "Солнечные ванны в меру укрепят иммунитет.",
                "Спина и позвоночник требуют регулярных упражнений.",
                "Творческие занятия положительно скажутся на здоровье."
            ]
        case .virgo:
            return [
                "Кишечник и обмен веществ требуют внимания.",
                "Чистота и гигиена помогут избежать инфекций.",
                "Трудоголизм может навредить нервной системе.",
                "Здоровое питание станет основой хорошего самочувствия."
            ]
        case .libra:
            return [
                "Почки и мочевыделительная система нуждаются в заботе.",
                "Гармония в жизни положительно скажется на здоровье.",
                "Поясница требует укрепления и растяжки.",
                "Красота и здоровье идут рука об руку."
            ]
        case .scorpio:
            return [
                "Репродуктивная система требует особого внимания.",
                "Детоксикация организма принесет значительное улучшение.",
                "Интенсивные эмоции могут влиять на физическое состояние.",
                "Трансформационные практики укрепят здоровье."
            ]
        case .sagittarius:
            return [
                "Бедра и печень нуждаются в поддержке.",
                "Активные путешествия и спорт укрепят организм.",
                "Оптимистичный настрой станет лучшим лекарством.",
                "Разнообразие в физической активности принесет пользу."
            ]
        case .capricorn:
            return [
                "Кости, суставы и колени требуют укрепления.",
                "Структурированный подход к здоровью принесет результаты.",
                "Кожа нуждается в особой заботе и защите.",
                "Дисциплина в здоровых привычках окупится сторицей."
            ]
        case .aquarius:
            return [
                "Кровообращение и лимфатическая система нуждаются в активации.",
                "Лодыжки и голени требуют внимания при физических нагрузках.",
                "Инновационные методы оздоровления могут оказаться эффективными.",
                "Дружеская поддержка поможет поддержать здоровые привычки."
            ]
        case .pisces:
            return [
                "Ноги и иммунная система требуют укрепления.",
                "Медитативные практики положительно скажутся на здоровье.",
                "Избегайте переутомления и стресса.",
                "Водные процедуры и плавание принесут исцеление."
            ]
        }
    }

    private func getAdviceTexts(for sign: ZodiacSign) -> [String] {
        switch sign {
        case .aries:
            return [
                "Подумайте дважды, прежде чем действовать импульсивно.",
                "Ваша энергия заразительна - используйте её для вдохновения других.",
                "Конкуренция хороша, но не забывайте о сотрудничестве.",
                "Инициатива ценится, но учитесь также следовать чужому лидерству."
            ]
        case .taurus:
            return [
                "Иногда стоит рискнуть и выйти из зоны комфорта.",
                "Ваша стабильность даёт другим чувство безопасности.",
                "Материальные блага важны, но не забывайте о духовном.",
                "Терпение - ваша сила, но знайте, когда нужно ускориться."
            ]
        case .gemini:
            return [
                "Сосредоточьтесь на одном деле, чтобы достичь глубины.",
                "Ваши слова имеют силу - используйте их мудро.",
                "Любознательность похвальна, но иногда нужна специализация.",
                "Гибкость мышления поможет найти неожиданные решения."
            ]
        case .cancer:
            return [
                "Доверяйте своей интуиции, она редко вас подводит.",
                "Забота о других важна, но не забывайте заботиться о себе.",
                "Эмоции - ваш компас, но разум поможет проложить маршрут.",
                "Дом - ваша крепость, но не бойтесь исследовать мир."
            ]
        case .leo:
            return [
                "Делитесь вниманием - сцена достаточно велика для всех.",
                "Ваш свет озаряет других, но помните о скромности.",
                "Творчество расцветает, когда вы искренни в самовыражении.",
                "Гордость - ваша сила, но не позволяйте ей стать слабостью."
            ]
        case .virgo:
            return [
                "Совершенство недостижимо, но стремление к нему делает вас лучше.",
                "Ваша помощь бесценна, но научитесь также принимать её от других.",
                "Детали важны, но не упускайте общую картину.",
                "Критичность полезна для улучшений, но добавьте к ней сострадание."
            ]
        case .libra:
            return [
                "Иногда нужно принимать решения, даже если они несовершенны.",
                "Ваше чувство справедливости вдохновляет окружающих.",
                "Гармония прекрасна, но конфликты иногда необходимы для роста.",
                "Красота в ваших глазах делает мир лучше."
            ]
        case .scorpio:
            return [
                "Ваша интенсивность может пугать - дозируйте её мудро.",
                "Трансформация болезненна, но приводит к возрождению.",
                "Секреты имеют силу, но иногда стоит быть открытым.",
                "Ваша страсть зажигает других, но учитесь контролировать огонь."
            ]
        case .sagittarius:
            return [
                "Мечты о дальних странах прекрасны, но не забывайте о доме.",
                "Ваш оптимизм заразителен - делитесь им щедро.",
                "Истина многогранна - будьте открыты к разным точкам зрения.",
                "Свобода ценна, но ответственность делает её значимой."
            ]
        case .capricorn:
            return [
                "Вершина достижима, но наслаждайтесь также путешествием к ней.",
                "Ваша дисциплина вдохновляет других на подвиги.",
                "Успех сладок, но не забывайте делиться плодами с близкими.",
                "Структура важна, но оставляйте место для спонтанности."
            ]
        case .aquarius:
            return [
                "Ваши идеи опережают время - будьте терпеливы к непониманию.",
                "Независимость ценна, но помните о силе командной работы.",
                "Будущее создается сегодня вашими действиями.",
                "Дружба для вас священна - цените и берегите её."
            ]
        case .pisces:
            return [
                "Ваша чувствительность - дар, защищайте её от грубого мира.",
                "Мечты питают душу, но не забывайте о практических шагах.",
                "Интуиция ведёт вас верным путём - доверяйте внутреннему голосу.",
                "Сострадание делает мир добрее, но не забывайте о границах."
            ]
        }
    }

    // Простейший генератор псевдослучайных чисел с семенем
    struct SeededRandomNumberGenerator: RandomNumberGenerator {
        private var state: UInt64

        init(seed: Int) {
            self.state = UInt64(seed)
        }

        mutating func next() -> UInt64 {
            state = state &* 1103515245 &+ 12345
            return state
        }
    }
}
